# Skenario Sistem Informasi Inventaris Barang

## Gambaran Umum Sistem

Sistem Informasi Inventaris Barang adalah aplikasi berbasis web yang dirancang untuk mengelola data persediaan barang, transaksi barang masuk dan keluar, serta pencatatan aktivitas pengguna. Sistem ini menggunakan arsitektur Model-View-Controller (MVC) dengan Node.js sebagai backend, Express.js sebagai framework web, PostgreSQL sebagai database, dan EJS sebagai template engine untuk rendering halaman. Sistem menerapkan konsep role-based access control (RBAC) yang membagi pengguna ke dalam enam peran berbeda: Superadmin, Admin, Operator, User, Supplier, dan Viewer, di mana setiap peran memiliki hak akses yang berbeda terhadap fitur-fitur dalam sistem.

## Alur Autentikasi dan Registrasi

Ketika pengguna pertama kali mengakses sistem, mereka akan diarahkan ke halaman login yang merupakan titik masuk tunggal untuk semua peran pengguna. Sistem tidak membedakan portal login berdasarkan peran; semua pengguna—baik Superadmin, Admin, Operator, User, Supplier, maupun Viewer—menggunakan halaman login yang sama di endpoint `/login`. Pada halaman ini, pengguna diminta memasukkan alamat email dan kata sandi mereka. Sistem melakukan normalisasi email dengan mengubahnya menjadi huruf kecil (lowercase) dan menghapus spasi, sehingga proses login tidak sensitif terhadap penggunaan huruf besar atau spasi yang tidak disengaja.

Setelah pengguna mengirimkan kredensial, sistem akan mencari data pengguna di tabel `users` berdasarkan email yang telah dinormalisasi menggunakan fungsi `LOWER()` di query database. Jika email ditemukan, sistem akan memverifikasi kata sandi yang diinputkan dengan hash kata sandi yang tersimpan di database menggunakan algoritma bcrypt dengan salt round 10. Bcrypt dipilih karena merupakan algoritma hashing yang aman dan lambat secara komputasi, sehingga melindungi dari serangan brute-force. Jika verifikasi berhasil, sistem akan membuat session untuk pengguna tersebut yang menyimpan informasi email dan role mereka. Session ini dikelola menggunakan middleware `cookie-session` yang menyimpan data session di dalam cookie yang dienkripsi di sisi client. Berdasarkan role yang tersimpan dalam session, sistem akan mengarahkan pengguna ke dashboard dengan tampilan dan fitur yang sesuai dengan hak akses role mereka.

Bagi pengguna baru yang belum memiliki akun, sistem menyediakan fitur registrasi publik melalui endpoint `/register`. Pada halaman registrasi, calon pengguna dapat mendaftarkan diri dengan mengisi formulir yang meminta alamat email, kata sandi (minimal 6 karakter), dan konfirmasi kata sandi. Sistem akan melakukan validasi menggunakan `express-validator` untuk memastikan email valid, kata sandi memenuhi panjang minimum, dan konfirmasi kata sandi sesuai. Sistem juga memeriksa apakah email sudah terdaftar sebelumnya dengan melakukan query ke database menggunakan pencarian case-insensitive. Jika email sudah ada, sistem akan menolak registrasi dan menampilkan pesan error. Jika validasi berhasil, sistem akan meng-hash kata sandi menggunakan bcrypt dan menyimpan data pengguna baru ke tabel `users` dengan role default "user". Setelah registrasi berhasil, sistem secara otomatis melakukan auto-login dengan membuat session untuk pengguna baru tersebut dan mengarahkan mereka langsung ke dashboard. Perlu dicatat bahwa pengguna yang mendaftar sendiri hanya akan mendapat role "user" secara default; untuk mendapatkan role lain seperti Admin, Operator, Supplier, atau Viewer, seorang Superadmin harus mengubah role mereka secara manual melalui database atau fitur manajemen pengguna.

## Dashboard dan Navigasi Berdasarkan Role

Setelah login berhasil, pengguna akan masuk ke dashboard yang tampilan dan isinya disesuaikan dengan role mereka. Controller dashboard (`dashboardController.js`) memeriksa role dari session dan mengirimkan data yang berbeda ke view berdasarkan role tersebut. Dashboard untuk Superadmin akan menampilkan statistik lengkap sistem termasuk total barang, total barang masuk, total barang keluar, dan total pengguna terdaftar. Superadmin juga akan melihat menu navigasi lengkap yang mencakup Dashboard, Stok Barang, Barang Masuk, Barang Keluar, Users, Logs, dan Account, karena Superadmin memiliki akses penuh ke seluruh fitur sistem termasuk manajemen pengguna dan log aktivitas.

Dashboard untuk Admin serupa dengan Superadmin dalam hal statistik barang, namun Admin tidak dapat mengakses menu Users dan Logs. Variabel `showAdminMenu` yang dikirim dari controller akan bernilai `false` untuk Admin, sehingga menu-menu tersebut tidak ditampilkan di navigation bar (`nav.ejs`). Admin tetap memiliki hak penuh untuk melakukan operasi CRUD (Create, Read, Update, Delete) pada master data barang (Stok Barang) dan transaksi (Barang Masuk/Keluar), tetapi mereka tidak dapat melihat atau mengelola pengguna sistem lain maupun memeriksa log aktivitas HTTP.

Dashboard untuk Operator dan User menampilkan statistik barang yang sama, tetapi dengan hak akses yang lebih terbatas. Mereka hanya dapat melihat (view) data master barang tanpa kemampuan untuk menambah, mengedit, atau menghapus item barang. Dalam hal transaksi, Operator dan User dapat menambahkan transaksi barang masuk dan barang keluar, tetapi tidak dapat mengedit atau menghapus transaksi yang sudah dibuat. Controller akan mengirimkan variabel `canAddTransactions` dengan nilai `true` ke view, yang mengontrol visibilitas tombol "Tambah" pada halaman Barang Masuk dan Barang Keluar. Tombol edit dan delete pada tabel transaksi tidak akan ditampilkan untuk role ini karena pemeriksaan kondisi `locals.user` yang membatasi akses tersebut hanya untuk Superadmin dan Admin.

Dashboard Supplier dirancang khusus untuk kebutuhan pemasok barang. Supplier dapat melihat seluruh master data barang untuk mengetahui item apa saja yang ada dalam sistem, tetapi mereka tidak dapat menambah, mengubah, atau menghapus barang. Dalam konteks transaksi, Supplier hanya memiliki hak untuk menambahkan transaksi Barang Masuk (karena peran mereka sebagai pemasok yang memasukkan barang ke gudang), sehingga tombol "Tambah" hanya akan muncul di halaman Barang Masuk. Pada halaman Barang Keluar, Supplier hanya dapat melihat data transaksi tanpa kemampuan untuk menambah, mengedit, atau menghapus, karena logika bisnis sistem menganggap Supplier tidak relevan dengan proses pengeluaran barang.

Dashboard Viewer adalah yang paling terbatas, dirancang untuk pengguna yang hanya perlu memonitor atau membuat laporan tanpa melakukan perubahan apapun terhadap data. Viewer dapat mengakses semua halaman untuk melihat data master barang, transaksi barang masuk, dan transaksi barang keluar, tetapi tidak ada tombol aksi (tambah, edit, delete) yang ditampilkan untuk mereka. Variabel `canAddTransactions` untuk Viewer bernilai `false`, sehingga tombol "Tambah" pada halaman transaksi tidak muncul, dan tabel transaksi hanya menampilkan data dalam mode read-only.

## Pengelolaan Master Data Barang (Stock)

Master data barang disimpan dalam tabel `stock` yang merupakan jantung dari sistem inventory. Setiap item barang memiliki atribut primary key `idbarang`, `namabarang` (nama deskriptif barang), `deskripsi` (penjelasan detail), `stock` (jumlah stok terkini), `kodebarang` (kode unik untuk identifikasi), dan `penginput` (email user yang menginput barang tersebut). Kolom `image` masih ada di skema database dari versi lama sistem, namun fitur upload gambar barang telah dihapus dalam versi saat ini sehingga kolom ini tidak lagi digunakan secara aktif.

Ketika Superadmin atau Admin mengakses halaman Stok Barang melalui `/barang`, mereka akan melihat tabel yang menampilkan seluruh barang yang terdaftar dalam sistem beserta informasi stok terkini, kode barang, nama, deskripsi, dan penginput. Pada halaman ini terdapat tombol "Tambah Barang" yang membuka modal form untuk menambahkan barang baru. Di dalam modal, pengguna diminta mengisi nama barang, deskripsi, stok awal, dan kode barang. Sistem secara otomatis akan mencatat email pengguna yang sedang login sebagai `penginput`. Ketika form disubmit, controller `barangController.js` akan memvalidasi data dan menyimpannya ke database, kemudian mengarahkan kembali ke halaman Stok Barang dengan data yang sudah diperbarui.

Catatan: Fitur QR code (pembuatan, tampilan, dan pencetakan) telah dihapus dari sistem. Identifikasi barang kini hanya mengandalkan `kodebarang` dalam tampilan tabel dan detail tanpa representasi QR.

Untuk role Operator, User, Supplier, dan Viewer, halaman Stok Barang hanya menampilkan data dalam mode read-only. Mereka dapat melihat detail setiap barang dengan mengklik row pada tabel yang akan membuka halaman detail barang (`/barang/:id`), namun tombol "Tambah Barang" tidak akan ditampilkan karena logika di controller memeriksa role sebelum merender view. Pada halaman detail, semua pengguna dapat melihat informasi lengkap barang, namun hanya Superadmin dan Admin yang dapat mengedit atau menghapus barang tersebut.

## Transaksi Barang Masuk (Masuk)

Transaksi barang masuk mencatat setiap penambahan stok barang ke dalam gudang atau inventaris. Data transaksi disimpan di tabel `masuk` dengan atribut `idmasuk` (primary key), `idbarang` (foreign key logis ke `stock.idbarang`), `tanggal` (timestamp otomatis saat transaksi dibuat), `keterangan` (alasan atau sumber barang masuk), `qty` (jumlah barang yang masuk), `penginput` (email user yang mencatat transaksi), serta kolom snapshot `namabarang_m` dan `kodebarang_m` yang menyimpan nilai nama dan kode barang pada saat transaksi dibuat untuk menjaga jejak historis meskipun data master barang berubah di kemudian hari.

Ketika pengguna dengan hak akses yang sesuai (Superadmin, Admin, Operator, User, atau Supplier) mengakses halaman Barang Masuk di `/barangmasuk`, mereka akan melihat tabel yang menampilkan semua transaksi barang masuk yang pernah terjadi, diurutkan dari yang terbaru. Tabel ini menampilkan kolom nomor urut, tanggal dan waktu transaksi (diformat dalam bahasa Indonesia menggunakan `moment.js`), kode barang, nama barang, jumlah, keterangan, dan penginput. Bagi pengguna yang memiliki hak tambah (semua role kecuali Viewer), terdapat tombol "Tambah Barang Masuk" yang membuka modal form.

Di dalam modal tambah barang masuk, pengguna diminta untuk memilih barang dari dropdown yang dipopulasi dengan data dari tabel `stock`. Dropdown ini menggunakan plugin `Select2` untuk memudahkan pencarian barang, terutama jika jumlah item banyak. Setelah memilih barang, pengguna memasukkan jumlah (qty) yang masuk dan keterangan (misalnya "Pembelian dari Supplier X" atau "Retur dari customer"). Ketika form disubmit, controller `barangMasukController.js` akan memproses data dalam sebuah transaksi database. Pertama, sistem akan menyimpan record baru ke tabel `masuk` dengan mengambil snapshot nama dan kode barang dari tabel `stock` saat itu. Kedua, sistem akan mengupdate kolom `stock` di tabel `stock` dengan menambahkan qty yang masuk. Query update menggunakan `stock = stock + qty` untuk memastikan operasi bersifat atomik dan aman dari race condition. Setelah transaksi berhasil, halaman akan di-refresh dan menampilkan data transaksi terbaru.

Untuk Superadmin dan Admin, setiap row di tabel transaksi dilengkapi dengan tombol edit (ikon pensil berwarna kuning) dan delete (ikon trash berwarna merah). Ketika tombol edit diklik, modal edit akan muncul dengan form yang sudah terisi data transaksi tersebut, dan pengguna dapat mengubah jumlah atau keterangan. Saat perubahan disimpan, controller akan menghitung selisih qty (qty baru dikurangi qty lama) dan mengupdate stok barang sesuai selisih tersebut. Jika qty dikurangi, stok akan berkurang; jika ditambah, stok akan bertambah. Tombol delete membuka modal konfirmasi yang menanyakan apakah pengguna yakin ingin menghapus transaksi tersebut. Jika dikonfirmasi, controller akan menghapus record dari tabel `masuk` dan mengurangi stok barang sejumlah qty transaksi yang dihapus.

Khusus untuk role Operator, User, dan Supplier, mereka hanya dapat menambahkan transaksi barang masuk tanpa kemampuan untuk mengedit atau menghapus. Hal ini menjaga integritas data historis dan mencegah manipulasi data oleh pengguna yang tidak berwenang. Viewer tidak memiliki kemampuan untuk menambah, mengedit, atau menghapus transaksi sama sekali; mereka hanya dapat melihat data untuk keperluan monitoring atau reporting.

## Transaksi Barang Keluar (Keluar)

Transaksi barang keluar mencatat setiap pengurangan stok barang dari inventaris, misalnya karena penjualan, pengiriman ke customer, atau penggunaan internal. Data disimpan di tabel `keluar` dengan struktur serupa dengan tabel `masuk`: `idkeluar` (primary key), `idbarang` (foreign key logis), `tanggal`, `penerima` (nama pihak yang menerima barang), `qty`, `penginput`, serta snapshot `namabarang_k` dan `kodebarang_k`.

Halaman Barang Keluar di `/barangkeluar` menampilkan tabel transaksi keluar dengan kolom serupa dengan halaman Barang Masuk, kecuali kolom "Keterangan" diganti dengan "Penerima" yang mencatat siapa atau pihak mana yang menerima barang tersebut. Bagi pengguna dengan hak tambah (Superadmin, Admin, Operator, dan User, tetapi tidak termasuk Supplier dan Viewer), terdapat tombol "Tambah Barang Keluar" yang membuka modal form.

Modal form barang keluar juga menggunakan dropdown Select2 untuk memilih barang, tetapi dengan penambahan logika bisnis: jika stok suatu barang habis (stock = 0), dropdown akan menampilkan label "(Habis)" di samping nama barang sebagai peringatan visual bahwa barang tersebut tidak tersedia. Namun, sistem tidak secara teknis memblokir pemilihan barang yang habis, karena validasi stok akan dilakukan di backend saat form disubmit. Pengguna juga memasukkan jumlah barang yang keluar dan nama penerima.

Ketika form disubmit, controller `barangKeluarController.js` akan melakukan validasi penting: memeriksa apakah stok barang saat ini mencukupi untuk qty yang diminta. Jika `stock < qty`, sistem akan menolak transaksi dan menampilkan pesan error "Stok tidak mencukupi" kepada pengguna tanpa melakukan perubahan apapun di database. Jika stok mencukupi, controller akan menyimpan record baru ke tabel `keluar` dan mengurangi stok di tabel `stock` dengan query `stock = stock - qty`. Hal ini memastikan bahwa stok tidak pernah menjadi negatif dan data selalu konsisten.

Seperti pada Barang Masuk, Superadmin dan Admin memiliki hak untuk mengedit dan menghapus transaksi barang keluar. Proses edit akan menghitung selisih qty dan menyesuaikan stok barang, serta memvalidasi bahwa stok tidak menjadi negatif setelah perubahan. Proses delete akan mengembalikan qty yang dihapus ke stok barang. Role Operator dan User dapat menambahkan transaksi barang keluar tetapi tidak dapat mengubah atau menghapusnya. Supplier hanya dapat melihat data transaksi barang keluar dalam mode read-only tanpa kemampuan menambah, karena logika bisnis sistem menganggap Supplier tidak terlibat dalam proses pengeluaran barang. Viewer, seperti biasa, hanya memiliki akses read-only.

## Manajemen Pengguna (Users)

Fitur manajemen pengguna hanya dapat diakses oleh Superadmin melalui menu Users di `/users`. Halaman ini menampilkan tabel semua pengguna yang terdaftar dalam sistem beserta informasi ID, email, dan role mereka. Tabel ini menggunakan DataTables untuk memudahkan pencarian, sorting, dan pagination jika jumlah pengguna banyak. Setiap row pengguna dilengkapi dengan tombol aksi: Edit (untuk mengubah email, password, atau role pengguna), Delete (untuk menghapus pengguna dari sistem), dan Reset Password (untuk mengembalikan password pengguna ke nilai default).

Ketika Superadmin mengklik tombol Edit pada pengguna tertentu, modal edit akan muncul dengan form yang berisi field email, password, dan dropdown role. Email dapat diubah, tetapi sistem akan melakukan validasi untuk memastikan email baru belum digunakan oleh pengguna lain. Password dapat dikosongkan jika tidak ingin diubah; jika diisi, password baru akan di-hash dengan bcrypt sebelum disimpan. Dropdown role memungkinkan Superadmin untuk mengubah role pengguna antara superadmin, admin, operator, user, supplier, atau viewer. Perubahan role akan langsung mempengaruhi hak akses pengguna tersebut pada login berikutnya.

Fitur Delete Pengguna membuka modal konfirmasi yang meminta Superadmin untuk memastikan tindakan penghapusan. Jika dikonfirmasi, record pengguna akan dihapus dari tabel `users`. Perlu dicatat bahwa penghapusan pengguna bersifat permanen dan dapat menyebabkan data yatim (orphan data) pada kolom `penginput` di tabel `stock`, `masuk`, dan `keluar` karena sistem menggunakan email sebagai soft foreign key tanpa constraint eksplisit. Oleh karena itu, Superadmin harus berhati-hati saat menghapus pengguna, terutama yang telah banyak menginput data.

Fitur Reset Password memungkinkan Superadmin untuk mengatur ulang password pengguna ke nilai default (misalnya "password" atau "12345678"). Ini berguna jika pengguna lupa password mereka. Setelah reset, Superadmin dapat memberi tahu pengguna bahwa password mereka telah direset dan meminta mereka untuk mengubahnya melalui fitur Account setelah login.

## Log Aktivitas HTTP

Sistem mencatat setiap request HTTP yang masuk ke dalam tabel `log` dengan atribut `idlog` (primary key), `date` (timestamp request), `usr` (email pengguna yang melakukan request, diambil dari session), `method` (GET, POST, PUT, DELETE), `endpoint` (URL path yang diakses), dan `status_code` (kode status HTTP response seperti 200, 302, 404, 500). Logging dilakukan menggunakan middleware `morgan` yang dikustomisasi untuk mengekstrak informasi pengguna dari session dan menyimpannya ke database.

Hanya Superadmin yang dapat mengakses halaman Logs di `/log` yang menampilkan tabel seluruh log aktivitas sistem. Tabel ini sangat berguna untuk audit trail, debugging, dan monitoring aktivitas pengguna. Superadmin dapat melihat siapa saja yang mengakses endpoint tertentu, kapan, dan apakah request berhasil atau mengalami error. Misalnya, jika terjadi error 500, Superadmin dapat melacak endpoint dan user yang terlibat untuk investigasi lebih lanjut. Log tidak dapat diedit atau dihapus melalui UI (meskipun secara teknis bisa dilakukan langsung di database), memastikan integritas data log sebagai bukti audit.

## Profil Pengguna dan Pengaturan Akun

Semua pengguna, tanpa terkecuali role, dapat mengakses halaman Account di `/account` untuk melihat dan mengelola profil mereka sendiri. Halaman ini menampilkan informasi email dan role pengguna saat ini. Pengguna dapat mengubah email mereka dengan memasukkan email baru dan mengkonfirmasinya. Sistem akan melakukan validasi untuk memastikan email baru valid dan belum digunakan oleh pengguna lain. Jika validasi berhasil, email akan diperbarui di database dan session akan diperbarui dengan email baru, sehingga pengguna tidak perlu login ulang.

Pengguna juga dapat mengubah password mereka melalui halaman Account. Form pengaturan password meminta pengguna untuk memasukkan password lama (untuk verifikasi identitas), password baru, dan konfirmasi password baru. Sistem akan memverifikasi bahwa password lama yang diinputkan sesuai dengan hash yang tersimpan di database menggunakan `bcrypt.compare()`. Jika cocok, dan password baru serta konfirmasinya sesuai, sistem akan meng-hash password baru dan menyimpannya ke database, menggantikan hash password lama. Ini adalah praktik keamanan standar untuk memastikan bahwa hanya pemilik akun yang dapat mengubah password.

Untuk Superadmin dan Admin, halaman Account mungkin menampilkan informasi atau opsi tambahan (tergantung implementasi spesifik), tetapi pada dasarnya semua pengguna memiliki kontrol penuh atas profil mereka sendiri. Perubahan yang dilakukan di halaman Account tidak mempengaruhi hak akses atau role pengguna, kecuali jika Superadmin mengubahnya melalui menu Users.

## Keamanan dan Validasi Data

Keamanan adalah aspek krusial dalam sistem ini. Semua password pengguna di-hash menggunakan bcrypt dengan salt round 10 sebelum disimpan ke database, memastikan bahwa password plaintext tidak pernah tersimpan dan tidak dapat di-recover bahkan jika database bocor. Session dikelola menggunakan `cookie-session` yang mengenkripsi data session di sisi client, melindungi dari session hijacking. Setiap request yang memerlukan autentikasi akan melalui middleware yang memeriksa keberadaan `req.session.user`; jika tidak ada, pengguna akan diarahkan ke halaman login.

Validasi input dilakukan di dua tingkat: client-side dan server-side. Pada form HTML, atribut seperti `required`, `min`, `max`, `type="number"`, dan `type="email"` memberikan validasi dasar di browser. Namun, sistem tidak mengandalkan validasi client-side saja karena dapat di-bypass oleh pengguna jahat. Oleh karena itu, setiap endpoint POST dan PUT di backend menggunakan `express-validator` untuk memvalidasi dan sanitasi input. Misalnya, pada registrasi, sistem memvalidasi bahwa email valid, password memiliki panjang minimal 6 karakter, dan konfirmasi password sesuai. Pada transaksi barang keluar, sistem memvalidasi bahwa qty adalah angka positif dan stok mencukupi.

Sistem juga menerapkan prinsip least privilege dalam role-based access control. Setiap controller memeriksa role pengguna sebelum mengizinkan akses ke fitur tertentu. Jika pengguna dengan role yang tidak sesuai mencoba mengakses endpoint yang terbatas (misalnya Viewer mencoba POST ke `/barangmasuk`), controller akan menolak request dengan error 403 Forbidden atau redirect ke halaman error. View juga menyembunyikan tombol aksi yang tidak relevan berdasarkan role, sehingga mengurangi kebingungan pengguna dan mencegah upaya akses tidak sah.

## Integrasi dengan AdminLTE dan Library Eksternal

Sistem menggunakan AdminLTE sebagai template UI yang menyediakan komponen siap pakai seperti navbar, sidebar, card, tabel, modal, dan form. AdminLTE berbasis Bootstrap 4, sehingga sistem mendapat manfaat dari responsive design yang membuat aplikasi dapat diakses dengan baik di desktop, tablet, maupun mobile. Sidebar navigasi (`nav.ejs`) secara dinamis menampilkan menu berdasarkan variabel yang dikirim dari controller, seperti `showAdminMenu` yang menentukan apakah menu Users dan Logs ditampilkan.

DataTables digunakan untuk menampilkan tabel data dengan fitur sorting, searching, dan pagination. Script `datatables.js` menginisialisasi DataTables pada tabel-tabel seperti tabel barang, barang masuk, barang keluar, users, dan log. DataTables juga terintegrasi dengan tombol export (Excel, PDF, Print) yang memungkinkan pengguna untuk mengekspor data tabel ke berbagai format, sangat berguna untuk pelaporan.

Select2 digunakan untuk meningkatkan pengalaman pengguna dalam memilih barang dari dropdown yang panjang. Select2 menyediakan fitur search box di dalam dropdown, sehingga pengguna dapat mengetik nama atau kode barang untuk menemukan item yang diinginkan dengan cepat tanpa harus scroll panjang.

Moment.js digunakan untuk formatting tanggal dan waktu dalam bahasa Indonesia. Semua timestamp dalam database disimpan dalam format UTC dengan tipe data `timestamp with time zone`, dan saat ditampilkan di UI, Moment.js akan mengkonversi dan memformat sesuai locale Indonesia (misalnya "31-10-2025 14:30:15").

## Workflow End-to-End: Contoh Kasus Penambahan Barang dan Transaksi

Untuk memberikan gambaran yang jelas, berikut adalah skenario end-to-end yang menggambarkan workflow sistem dari perspektif berbagai role:

**Skenario 1: Superadmin Menambahkan Barang Baru**  
Superadmin login menggunakan email `superadmin@email.com` dan password `superadmin123`. Setelah autentikasi berhasil, Superadmin diarahkan ke dashboard yang menampilkan statistik lengkap sistem. Superadmin kemudian mengklik menu "Stok Barang" di sidebar dan diarahkan ke halaman `/barang`. Di halaman ini, Superadmin melihat tabel seluruh barang yang ada. Untuk menambah barang baru, Superadmin mengklik tombol "Tambah Barang" yang membuka modal form. Superadmin mengisi nama barang "Laptop Dell Latitude 5420", deskripsi "Laptop bisnis dengan Intel Core i5", stok awal 10, dan kode barang "DLL542010". Setelah submit, controller menyimpan data ke tabel `stock` dengan `penginput = superadmin@email.com` dan redirect ke halaman Stok Barang.

**Skenario 2: Supplier Menambahkan Transaksi Barang Masuk**  
Setelah Superadmin mengubah role akun `usr@email.com` menjadi "supplier" melalui menu Users, pengguna tersebut login dengan email `usr@email.com` dan password `password`. Dashboard Supplier menampilkan statistik barang tetapi menu Users dan Logs tidak ada. Supplier mengklik menu "Barang Masuk" dan diarahkan ke halaman `/barangmasuk`. Supplier melihat tombol "Tambah Barang Masuk" dan mengkliknya. Modal form muncul dengan dropdown barang yang menggunakan Select2. Supplier mencari "Laptop Dell" di search box, memilih "DLL542010 - Laptop Dell Latitude 5420", mengisi qty 5, dan keterangan "Pengadaan dari Supplier PT. XYZ". Setelah submit, controller memproses transaksi: menyimpan record ke tabel `masuk` dengan snapshot nama dan kode barang, kemudian mengupdate stok di tabel `stock` dari 10 menjadi 15. Halaman refresh dan menampilkan transaksi baru di tabel. Supplier tidak melihat tombol edit atau delete pada transaksi karena role-nya tidak memiliki hak tersebut.

**Skenario 3: Operator Melakukan Transaksi Barang Keluar**  
Operator dengan email `operator@email.com` login dan mengakses halaman "Barang Keluar". Operator mengklik tombol "Tambah Barang Keluar", memilih barang "Laptop Dell Latitude 5420" dari dropdown, mengisi qty 3, dan penerima "PT. ABC untuk project X". Saat form disubmit, controller melakukan validasi: stok saat ini adalah 15, dan qty yang diminta 3, sehingga validasi berhasil (15 >= 3). Controller menyimpan transaksi ke tabel `keluar` dan mengurangi stok menjadi 12. Halaman refresh menampilkan transaksi baru. Jika Operator mencoba menambahkan transaksi barang keluar dengan qty 20 (lebih dari stok 12), controller akan menolak dengan pesan error "Stok tidak mencukupi" dan tidak ada perubahan di database.

**Skenario 4: Admin Mengedit Transaksi Barang Masuk**  
Admin dengan email `admin@email.com` login dan mengakses halaman "Barang Masuk". Admin melihat transaksi yang dibuat oleh Supplier sebelumnya (qty 5) dan menyadari ada kesalahan: seharusnya qty adalah 6, bukan 5. Admin mengklik tombol edit pada row transaksi tersebut, modal edit muncul dengan form terisi qty 5. Admin mengubah qty menjadi 6 dan submit. Controller menghitung selisih: 6 - 5 = 1, kemudian mengupdate record transaksi di tabel `masuk` dan menambahkan 1 ke stok barang di tabel `stock`, sehingga stok menjadi 13. Perubahan tersimpan dan tabel diperbarui.

**Skenario 5: Viewer Melihat Laporan Tanpa Melakukan Perubahan**  
Viewer dengan email `viewer@email.com` login dan mengakses dashboard yang hanya menampilkan statistik tanpa tombol aksi. Viewer mengklik menu "Stok Barang" dan melihat seluruh data barang dalam tabel, tetapi tidak ada tombol "Tambah Barang". Viewer mengklik menu "Barang Masuk" dan "Barang Keluar" untuk melihat histori transaksi, tetapi tidak ada tombol "Tambah", "Edit", atau "Delete" yang muncul. Viewer dapat menggunakan fitur search dan export di DataTables untuk membuat laporan dalam format Excel atau PDF, memenuhi kebutuhan reporting tanpa risiko mengubah data.

**Skenario 6: Superadmin Mengubah Role Pengguna dan Melihat Log**  
Superadmin memutuskan untuk mempromosikan User dengan email `user@email.com` menjadi Admin. Superadmin mengakses menu "Users", mencari row dengan email `user@email.com`, dan mengklik tombol edit. Di modal edit, Superadmin mengubah dropdown role dari "user" menjadi "admin" dan submit. Controller memperbarui role di tabel `users`. Pada login berikutnya, pengguna tersebut akan memiliki hak akses Admin. Superadmin kemudian mengakses menu "Logs" untuk memeriksa aktivitas sistem. Superadmin melihat entri log yang mencatat bahwa `admin@email.com` melakukan PUT request ke `/barangmasuk/:id` dengan status 302, menunjukkan bahwa Admin berhasil mengedit transaksi barang masuk sebelumnya.

## Kesimpulan

Sistem Informasi Inventaris Barang dirancang dengan arsitektur yang modular, aman, dan scalable, menerapkan prinsip-prinsip separation of concerns melalui pola MVC dan role-based access control yang ketat. Setiap komponen sistem—dari autentikasi, manajemen master data, transaksi, hingga logging—dirancang untuk saling terintegrasi dengan mulus sambil menjaga integritas data dan keamanan. Penggunaan library modern seperti bcrypt untuk hashing password, express-validator untuk validasi input, dan cookie-session untuk manajemen session memastikan bahwa sistem memenuhi standar keamanan web yang baik. Integrasi dengan AdminLTE, DataTables, Select2, dan library eksternal lainnya memberikan pengalaman pengguna yang responsif dan intuitif. Sistem ini fleksibel untuk dikembangkan lebih lanjut, misalnya dengan menambahkan constraint foreign key eksplisit di database, implementasi soft delete untuk data historis, atau integrasi dengan sistem eksternal melalui API. Dokumentasi alur skenario ini memberikan pemahaman holistik tentang bagaimana sistem bekerja dari berbagai perspektif role, memfasilitasi onboarding pengguna baru, training, dan pengembangan fitur masa depan.
